<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spent</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="iconospentios.png">
  <link rel="apple-touch-icon" href="iconospentios.png">

  <!-- Librer√≠as externas (compat para mantener tu c√≥digo original) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- Inicializaci√≥n de Firebase en el script.js (protecci√≥n incluida) -->
  <script defer src="script.js"></script>
</head>
<body>

  <!-- üîπ Formulario de Login -->
  <div id="login-container" class="login-container">
    <h2>Iniciar Sesi√≥n</h2>
    <input type="email" id="login-email" placeholder="Correo electr√≥nico" class="apple-input">
    <input type="password" id="login-password" placeholder="Contrase√±a" class="apple-input">
    <div class="login-actions">
      <button id="login-button" class="apple-button">Iniciar Sesi√≥n</button>
      <button id="register-button" class="apple-button-secondary">Registrarse</button>
    </div>
    <p id="login-message" class="info"></p>
  </div>

  <!-- üîπ App (oculta hasta login) -->
  <div id="app-container" style="display:none;">
    <header class="app-header">
      <div class="app-title-group">
        <img src="spendsalternativo.png" alt="Spent Logo" class="title-logo">
        <h1>Spent</h1>
      </div>
      <div class="header-actions">
        <button id="export-button" class="export-button">
          <img src="exportar.png" alt="Exportar">
        </button>
        <button id="logout-button" class="logout-button">Log Out</button>
      </div>
    </header>

    <nav class="category-tabs-nav">
      <div id="category-tabs-scroll-wrapper" class="category-tabs-scroll-wrapper">
        <button class="category-tab active" data-category-name="General" data-category-id="general-fixed">General</button>
      </div>
    </nav>

    <main id="main-content" class="main-content">
      <div id="view-General" class="category-main-view active" data-category="General">
        <div class="summary-card">
          <span class="card-title">GENERAL</span>
          <span class="card-total-amount" id="general-total-amount">0.00‚Ç¨</span>
        </div>
        <div class="categories-list-card">
          <span class="card-title">Categor√≠as</span>
          <div id="categories-grid"></div>
          <button id="add-new-category-button" class="apple-button full-width-button">A√±adir nueva categor√≠a</button>
        </div>
        <div class="chart-card">
          <span class="card-title">Gastos por Categor√≠a</span>
          <div class="chart-container">
            <canvas id="expensesPieChart"></canvas>
          </div>
          <p id="no-chart-data-message" class="info hidden">No hay gastos en categor√≠as para mostrar en el gr√°fico.</p>
        </div>
        <button id="Invitar" class="apple-button-secondary">
          Recomendar a <br> un amigo <img src="was.png" class="button-icon">
        </button>
        <button id="Info" class="apple-button-secondary">
          Info <img src="info.png" alt="Informaci√≥n" class="button-icon">
        </button>
      </div>

      <!-- Plantilla para vistas de categor√≠a (se clona desde JS) -->
      <div id="template-category-view" class="category-main-view hidden" data-category-template>
        <div class="summary-card">
          <span class="card-title category-specific-title"></span>
          <span class="card-total-amount category-specific-total">0.00‚Ç¨</span>
        </div>
        <div class="add-expense-section">
          <button class="apple-button full-width-button add-expense-category-button">A√±adir Nuevo Gasto</button>
        </div>
        <ul class="expense-list"></ul>
        <p class="no-expenses hidden">No hay gastos en esta categor√≠a a√∫n.</p>
      </div>
    </main>
  </div>

  <!-- ===== Modales (agregados para asegurar que el script encuentre los elementos) ===== -->
  <!-- Modal: A√±adir / Editar Gasto -->
  <div id="expense-modal" class="modal hidden">
    <div class="modal-content">
      <h3 id="expense-modal-title">Nuevo Gasto</h3>
      <label>Monto</label>
      <input id="modal-expense-amount" type="number" step="0.01">
      <label>Descripci√≥n</label>
      <input id="modal-expense-description" type="text">
      <label>Fecha</label>
      <input id="modal-expense-date" type="date">
      <label>Categor√≠a</label>
      <select id="modal-expense-category-select"></select>
      <p id="expense-modal-message" class="info"></p>
      <div class="modal-actions">
        <button id="confirm-expense-button" class="apple-button">Confirmar</button>
        <button id="cancel-expense-button" class="apple-button-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal: A√±adir Categor√≠a -->
  <div id="add-category-modal" class="modal hidden">
    <div class="modal-content">
      <h3>A√±adir Categor√≠a</h3>
      <input id="new-category-input" type="text" placeholder="Nombre de la categor√≠a">
      <p id="category-modal-message" class="info"></p>
      <div class="modal-actions">
        <button id="confirm-add-category" class="apple-button">A√±adir</button>
        <button id="cancel-add-category" class="apple-button-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Editar Categor√≠a -->
  <div id="edit-category-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Editar Categor√≠a</h3>
      <input id="edit-category-input" type="text">
      <p id="edit-category-message" class="info"></p>
      <div class="modal-actions">
        <button id="confirm-edit-category-button" class="apple-button">Guardar</button>
        <button id="cancel-edit-category-button" class="apple-button-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Confirmar Borrado -->
  <div id="confirm-delete-modal" class="modal hidden">
    <div class="modal-content">
      <p id="confirm-delete-message"></p>
      <div class="modal-actions">
        <button id="confirm-delete-button" class="apple-button">S√≠, eliminar</button>
        <button id="cancel-delete-button" class="apple-button-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal: Info -->
  <div id="info-modal" class="modal hidden">
    <div class="modal-content">
      <div id="info-text-content"></div>
      <div class="modal-actions">
        <button id="close-info-button" class="apple-button-secondary">Cerrar</button>
      </div>
    </div>
  </div>

</body>
</html>